create or replace NONEDITIONABLE TRIGGER TRG_AUDITORIA_TIPODOCUMENTO
AFTER INSERT OR UPDATE OR DELETE ON TIPODOCUMENTO
FOR EACH ROW
DECLARE
    v_operacion VARCHAR2(20);
    v_TIPODOCUMENTO_id NUMBER;
BEGIN
    -- Determinar tipo de operación
    IF INSERTING THEN
        v_operacion := 'INSERT';
        v_TIPODOCUMENTO_id := :NEW.TIPODOCUMENTOID;
    ELSIF UPDATING THEN
        v_operacion := 'UPDATE';
        v_TIPODOCUMENTO_id := :OLD.TIPODOCUMENTOID;
    ELSIF DELETING THEN
        v_operacion := 'DELETE';
        v_TIPODOCUMENTO_id := :OLD.TIPODOCUMENTOID;
    END IF;

    -- Insertar registro en la tabla de auditoría
    INSERT INTO AUDITORIA_TIPODOCUMENTO (
        OPERACION,
        TIPODOCUMENTO_ID,
        DESCRIPCION_ANTERIOR,
        DESCRIPCION_NUEVO,
        FECHA_OPERACION
    )
    VALUES (
        v_operacion,
        v_TIPODOCUMENTO_id,
        :OLD.DESCRIPCION, :NEW.DESCRIPCION,
        SYSDATE
    );
END;



CREATE TABLE AUDITORIA_TIPODOCUMENTO (  
    AUDITORIA_ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    OPERACiON varchar2(20),
    TIPODOCUMENTO_ID NUMBER,
    DESCRIPCION_ANTERIOR varchar2(100),
    DESCRIPCION_NUEVO varchar2(100),
    FECHA_OPERACION DATE DEFAULT SYSDATE
 )
